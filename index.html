<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Ouvinte Rep√≥rter ‚Äì R√°dio Nova Cotia</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #001a33;
  color: #fff;
}

h2 {
  text-align: center;
  margin-top: 20px;
}

.subtitulo {
  text-align: center;
  font-size: 18px;
  margin-bottom: 20px;
  color: #cfe2ff;
}

#feed {
  position: relative;
  max-width: 900px;
  height: 450px;
  margin: auto;
  overflow: hidden;
  border-radius: 12px;
  background: #000;
}

#slides {
  display: flex;
  height: 100%;
  transition: transform 0.6s ease;
}

.slide {
  min-width: 100%;
  height: 100%;
  position: relative;
}

.slide img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.caption {
  position: absolute;
  bottom: 0;
  width: 100%;
  background: linear-gradient(transparent, rgba(0,0,0,0.85));
  padding: 20px;
  font-size: 18px;
  box-sizing: border-box;
}

.loading {
  text-align: center;
  padding-top: 180px;
  font-size: 18px;
}

.nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0,0,0,0.6);
  border: none;
  color: white;
  font-size: 24px;
  width: 45px;
  height: 45px;
  cursor: pointer;
  border-radius: 50%;
}

.prev { left: 10px; }
.next { right: 10px; }
</style>
</head>

<body>

<h2>Ouvinte Rep√≥rter</h2>
<div class="subtitulo">A voz da popula√ß√£o mostrando os problemas da cidade</div>

<div id="feed">
  <div id="slides">
    <div class="loading">Carregando den√∫ncias...</div>
  </div>
  <button class="nav prev" onclick="moveSlide(-1)">‚ùÆ</button>
  <button class="nav next" onclick="moveSlide(1)">‚ùØ</button>
</div>

<script>
// üëá Link da sua planilha CSV publicado
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQF6Pkq50WVPuYUz4OpZ8PcXUJzmKuy1WfAFWyiMET4XhVZaeWIVfy8SIgeuHs77jwi1gRHHHR0VmW-/pub?output=csv";

let currentIndex = 0;
let totalSlides = 0;

async function carregarFeed() {
  try {
    const res = await fetch(CSV_URL + "&t=" + Date.now());
    const text = await res.text();
    const linhas = text.split("\n").map(l => l.split(","));
    const slides = document.getElementById("slides");
    slides.innerHTML = "";  // Limpa antes de preencher

    for (let i = 1; i < linhas.length; i++) {
      const row = linhas[i];

      const texto = row[4];    // coluna E
      const imagem = row[5];   // coluna F
      const status = row[8]?.trim().toUpperCase();  // coluna I

      if (status === "SIM" && imagem) {
        let imgFinal = imagem;

        // Se tiver link do Drive no formato /d/
        if (imagem.includes("/d/")) {
          const id = imagem.split("/d/")[1].split("/")[0];
          imgFinal = `https://drive.google.com/uc?export=view&id=${id}`;
        }

        slides.innerHTML += `
          <div class="slide">
            <img src="${imgFinal}" onerror="this.src='https://via.placeholder.com/800x450/001a33/ffffff?text=Imagem+Indisponivel'">
            <div class="caption">${texto}</div>
          </div>
        `;
      }
    }

    totalSlides = document.querySelectorAll(".slide").length;

    if (totalSlides === 0) {
      slides.innerHTML = "<div class='loading'>Nenhuma den√∫ncia aprovada no momento.</div>";
    }
  } catch (e) {
    document.getElementById("slides").innerHTML = "<div class='loading'>Erro ao carregar dados.</div>";
  }
}

function moveSlide(direction) {
  if (totalSlides === 0) return;
  currentIndex = (currentIndex + direction + totalSlides) % totalSlides;
  document.getElementById("slides").style.transform =
    `translateX(-${currentIndex * 100}%)`;
}

// Inicia o feed
carregarFeed();

// Autoplay a cada 6 segundos
setInterval(() => moveSlide(1), 6000);
</script>

</body>
</html>

